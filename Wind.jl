function WindCalc()
    PENETRATION = [0 15 25 35]
    WIND_DIV_PORT = [1  0]
    # CAPEX	1
    # HIDIV	0
    RAMP_DOWN = 1
    NORM = 2
    RAMP_UP = 3
    FULL =4



    name = "diff.dat"
    strfn = strpath*name
    ithCol = 2
    DIFF = ReadDataCol!(strfn,nMaxRow, ithCol)
    
    LOW_LIMIT =	-200
    HI_LIMIT =	200

    CLASS = 2*ones(T)
    for t = 1:T
        CLASS[t] = NORM
        if DIFF[t] <= LOW_LIMIT
            CLASS[t] = RAMP_DOWN
        end
        if DIFF[t] >= HI_LIMIT 
            CLASS[t] = RAMP_UP
        end
    end
            
            
    CRO_WIND = [0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05
    0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05
    0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05
    0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05	0.05
    ]

    REGUP_WIND_RAMP_DOWN_CAPEX = [0	 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    13.97	8.78	7.84	8.56	12.18	13.88	17.31	25.28	24.15	21.98	18.23	19.37	13.97	8.78	7.84	8.56	12.18	13.88	17.31	25.28	24.15	21.98	18.23	19.37
    26.33	15.41	13.28	14.69	21.29	23.37	29.87	46.34	37.19	36.19	32.22	34.02	26.33	15.41	13.28	14.69	21.29	23.37	29.87	46.34	37.19	36.19	32.22	34.02
    33.13	26.57	21.46	22.24	28.68	29.98	35.02	50.79	43.93	40.89	36.08	38.91	33.13	26.57	21.46	22.24	28.68	29.98	35.02	50.79	43.93	40.89	36.08	38.91
    ]

    REGDN_WIND_RAMP_DOWN_CAPEX = [0	 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -11.14	-6.95	-8.05	-8.46	-10.85	-13.82	-17.18	-26.91	-25.46	-23.42	-19.61	-18.67	-11.14	-6.95	-8.05	-8.46	-10.85	-13.82	-17.18	-26.91	-25.46	-23.42	-19.61	-18.67
    -21.16	-12.72	-13.78	-14.7	-18.33	-24.67	-29.15	-46.58	-42.54	-39.2	-36.56	-33.38	-21.16	-12.72	-13.78	-14.7	-18.33	-24.67	-29.15	-46.58	-42.54	-39.2	-36.56	-33.38
    -28.25	-21.46	-21.64	-22.86	-24.67	-32.46	-34.14	-53.49	-46.72	-44.35	-40.74	-38.87	-28.25	-21.46	-21.64	-22.86	-24.67	-32.46	-34.14	-53.49	-46.72	-44.35	-40.74	-38.87
    ]

    FOLUP_WIND_RAMP_DOWN_CAPEX = [0	 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    65.21	76.58	78.39	80.52	111.06	91.37	98.7	85.81	98.53	87.73	84.55	140.86	65.21	76.58	78.39	80.52	111.06	91.37	98.7	85.81	98.53	87.73	84.55	140.86
    161.74	174.56	166.93	182.46	255.79	214.83	219.52	195.68	215.35	180.93	195.21	291.72	161.74	174.56	166.93	182.46	255.79	214.83	219.52	195.68	215.35	180.93	195.21	291.72
    206.62	201.88	191.29	214.74	284.41	241.34	252.52	222.2	266.38	222.79	228.2	313.56	206.62	201.88	191.29	214.74	284.41	241.34	252.52	222.2	266.38	222.79	228.2	313.56
    ]

    FOLDN_WIND_RAMP_DOWN_CAPEX = [0	 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -152.98	-128.2	-66.89	-98.65	-184.11	-117.32	-120.73	-170.64	-181.95	-158.79	-133.53	-116.98	-152.98	-128.2	-66.89	-98.65	-184.11	-117.32	-120.73	-170.64	-181.95	-158.79	-133.53	-116.98
    -345.6	-248.22	-150.16	-239.24	-326.84	-251.41	-253.26	-299.92	-317.98	-306.63	-276.66	-253	-345.6	-248.22	-150.16	-239.24	-326.84	-251.41	-253.26	-299.92	-317.98	-306.63	-276.66	-253
    -415.66	-309.73	-193.72	-266.43	-410.24	-297.42	-308.09	-363.73	-393.31	-357.42	-347.5	-288.54	-415.66	-309.73	-193.72	-266.43	-410.24	-297.42	-308.09	-363.73	-393.31	-357.42	-347.5	-288.54
    ]

    REGUP_WIND_NORM_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    12.49	8.53	7.91	8.3	11.9	14.64	17.97	21.95	25.96	23.09	18.93	18.36	12.49	8.53	7.91	8.3	11.9	14.64	17.97	21.95	25.96	23.09	18.93	18.36
    23.84	14.99	13.39	14.27	20.84	24.51	30.86	41.31	39.66	37.79	33.3	32.51	23.84	14.99	13.39	14.27	20.84	24.51	30.86	41.31	39.66	37.79	33.3	32.51
    30.17	25.94	21.62	21.65	28.14	31.34	36.12	45.48	46.68	42.7	37.25	37.26	30.17	25.94	21.62	21.65	28.14	31.34	36.12	45.48	46.68	42.7	37.25	37.26
    ]

    REGDN_WIND_NORM_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -10.12	-7.5	-7.45	-7	-10.18	-12.98	-18.24	-22.29	-30.26	-27.74	-21.08	-18.03	-10.12	-7.5	-7.45	-7	-10.18	-12.98	-18.24	-22.29	-30.26	-27.74	-21.08	-18.03
    -19.4	-13.68	-12.82	-12.29	-17.28	-23.35	-30.74	-39.8	-49.38	-45.46	-38.88	-32.38	-19.4	-13.68	-12.82	-12.29	-17.28	-23.35	-30.74	-39.8	-49.38	-45.46	-38.88	-32.38
    -26.03	-22.94	-20.25	-19.37	-23.36	-30.84	-35.92	-46.11	-54.01	-51.11	-43.23	-37.77	-26.03	-22.94	-20.25	-19.37	-23.36	-30.84	-35.92	-46.11	-54.01	-51.11	-43.23	-37.77
    ]

    FOLUP_WIND_NORM_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    92.78	110.01	100.59	99.28	132.52	119.68	129.93	115.59	118.22	119.95	114.99	139.54	92.78	110.01	100.59	99.28	132.52	119.68	129.93	115.59	118.22	119.95	114.99	139.54
    217	234.46	205.38	216.95	293.9	267.06	274.29	248.75	249.04	234.26	249.2	292.71	217	234.46	205.38	216.95	293.9	267.06	274.29	248.75	249.04	234.26	249.2	292.71
    271.72	267.48	233.89	253.32	325.36	297.75	312.4	279.85	304.76	283.32	287.75	315.66	271.72	267.48	233.89	253.32	325.36	297.75	312.4	279.85	304.76	283.32	287.75	315.66
    ]

    FOLDN_WIND_NORM_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -150.74	-148.32	-83.38	-118.22	-175.83	-131.72	-148.68	-175.49	-210.58	-166.83	-164.45	-153.2	-150.74	-148.32	-83.38	-118.22	-175.83	-131.72	-148.68	-175.49	-210.58	-166.83	-164.45	-153.2
    -346.31	-281.13	-182.17	-275.72	-321.12	-278.28	-300.99	-313.56	-358.78	-319.93	-325.28	-313.6	-346.31	-281.13	-182.17	-275.72	-321.12	-278.28	-300.99	-313.56	-358.78	-319.93	-325.28	-313.6
    -417.68	-347.26	-232.38	-306.27	-404.32	-327.76	-361.63	-379.06	-438.76	-372.42	-402.11	-354.14	-417.68	-347.26	-232.38	-306.27	-404.32	-327.76	-361.63	-379.06	-438.76	-372.42	-402.11	-354.14
    ]

    REGUP_WIND_RAMP_UP_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    10.4	6.32	7.01	7.38	7.87	12.2	15.07	19.74	26.93	22.67	16.55	14.68	10.4	6.32	7.01	7.38	7.87	12.2	15.07	19.74	26.93	22.67	16.55	14.68
    20.18	11.3	11.95	12.78	14.21	20.77	26.43	37.8	40.95	37.19	29.59	26.69	20.18	11.3	11.95	12.78	14.21	20.77	26.43	37.8	40.95	37.19	29.59	26.69
    25.75	20.03	19.47	19.53	19.61	26.83	31.16	41.74	48.11	43.08	33.23	30.83	25.75	20.03	19.47	19.53	19.61	26.83	31.16	41.74	48.11	43.08	33.23	30.83
    ]

    REGDN_WIND_RAMP_UP_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -10.11	-6.35	-7.36	-6.89	-9.27	-12.68	-17.01	-22.56	-29.4	-28.48	-17.44	-13.53	-10.11	-6.35	-7.36	-6.89	-9.27	-12.68	-17.01	-22.56	-29.4	-28.48	-17.44	-13.53
    -19.37	-11.68	-12.68	-12.11	-15.85	-22.86	-28.9	-40.22	-48.18	-46.49	-33	-25.08	-19.37	-11.68	-12.68	-12.11	-15.85	-22.86	-28.9	-40.22	-48.18	-46.49	-33	-25.08
    -26.01	-19.81	-20.04	-19.09	-21.53	-30.24	-33.86	-46.57	-52.74	-52.24	-36.89	-29.55	-26.01	-19.81	-20.04	-19.09	-21.53	-30.24	-33.86	-46.57	-52.74	-52.24	-36.89	-29.55
    ]

    FOLUP_WIND_RAMP_UP_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    72.06	74.73	80.26	87.51	132.06	128.39	96.35	96.29	100.38	96.78	102.52	119.66	72.06	74.73	80.26	87.51	132.06	128.39	96.35	96.29	100.38	96.78	102.52	119.66
    174.04	169.22	168.82	192.79	286.64	274.35	213.26	212.21	217.66	195.29	225.44	255.89	174.04	169.22	168.82	192.79	286.64	274.35	213.26	212.21	217.66	195.29	225.44	255.89
    221.19	194.84	192.31	224.84	314.86	302.91	244.56	238.84	268.29	238.91	260.65	275.4	221.19	194.84	192.31	224.84	314.86	302.91	244.56	238.84	268.29	238.91	260.65	275.4
    ]

    FOLDN_WIND_RAMP_UP_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -128.14	-118.35	-54.24	-73.8	-130.8	-118.13	-119.96	-138.74	-152.36	-139.49	-138.69	-107.55	-128.14	-118.35	-54.24	-73.8	-130.8	-118.13	-119.96	-138.74	-152.36	-139.49	-138.69	-107.55
    -301.3	-230.99	-124.97	-189.3	-246.95	-250.82	-249.97	-253.74	-274.22	-276.93	-283.75	-235.13	-301.3	-230.99	-124.97	-189.3	-246.95	-250.82	-249.97	-253.74	-274.22	-276.93	-283.75	-235.13
    -366.03	-289.67	-163.04	-212.34	-318.81	-296.16	-304.13	-312.38	-343.64	-325.31	-355.16	-268.61	-366.03	-289.67	-163.04	-212.34	-318.81	-296.16	-304.13	-312.38	-343.64	-325.31	-355.16	-268.61
    ]

    REGUP_WIND_FULL_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    11.73	7.37	7.39	7.7	9.43	13.24	16.85	21.48	25.82	22.88	18.24	17.44	11.73	7.37	7.39	7.7	9.43	13.24	16.85	21.48	25.82	22.88	18.24	17.44
    22.54	13.07	12.55	13.3	16.85	22.39	29.18	40.58	39.46	37.49	32.24	31.09	22.54	13.07	12.55	13.3	16.85	22.39	29.18	40.58	39.46	37.49	32.24	31.09
    28.61	22.91	20.38	20.28	23.06	28.8	34.25	44.7	46.47	42.66	36.1	35.71	28.61	22.91	20.38	20.28	23.06	28.8	34.25	44.7	46.47	42.66	36.1	35.71
    ]

    REGDN_WIND_FULL_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -10.22	-7.18	-7.48	-7.11	-9.99	-13.03	-17.68	-22.75	-29.35	-27.58	-19.79	-17	-10.22	-7.18	-7.48	-7.11	-9.99	-13.03	-17.68	-22.75	-29.35	-27.58	-19.79	-17
    -19.58	-13.13	-12.87	-12.48	-16.98	-23.42	-29.91	-40.5	-48.11	-45.23	-36.84	-30.77	-19.58	-13.13	-12.87	-12.48	-16.98	-23.42	-29.91	-40.5	-48.11	-45.23	-36.84	-30.77
    -26.27	-22.1	-20.32	-19.64	-22.97	-30.93	-34.99	-46.89	-52.67	-51.23	-41.05	-35.97	-26.27	-22.1	-20.32	-19.64	-22.97	-30.93	-34.99	-46.89	-52.67	-51.23	-41.05	-35.97
    ]

    FOLUP_WIND_FULL_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    73.28	84.9	81.25	86.03	120.78	103.32	106.19	96.28	102.17	101.56	103.89	127.55	73.28	84.9	81.25	86.03	120.78	103.32	106.19	96.28	102.17	101.56	103.89	127.55
    176.99	188.24	170.96	190.73	269.55	235.03	231.14	212.97	221.1	203.53	228.48	269.61	176.99	188.24	170.96	190.73	269.55	235.03	231.14	212.97	221.1	203.53	228.48	269.61
    224.78	215.83	194.97	222.88	297.4	262.06	264.27	240.02	272.45	248.36	264.28	290.07	224.78	215.83	194.97	222.88	297.4	262.06	264.27	240.02	272.45	248.36	264.28	290.07
    ]

    FOLDN_WIND_FULL_CAPEX = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -137.28	-126.08	-66.28	-86.53	-157.14	-119.44	-135.06	-159.95	-183.5	-156.87	-152.65	-136.83	-137.28	-126.08	-66.28	-86.53	-157.14	-119.44	-135.06	-159.95	-183.5	-156.87	-152.65	-136.83
    -317.77	-243.36	-148.72	-215.48	-286.85	-253.81	-275.13	-284.67	-319.19	-303.7	-305.3	-284.28	-317.77	-243.36	-148.72	-215.48	-286.85	-253.81	-275.13	-284.67	-319.19	-303.7	-305.3	-284.28
    -384.51	-303.82	-191.86	-240.58	-365.03	-299.72	-332.39	-346.89	-394.43	-354.32	-379.29	-321.67	-384.51	-303.82	-191.86	-240.58	-365.03	-299.72	-332.39	-346.89	-394.43	-354.32	-379.29	-321.67
    ]


    REGUP_WIND_RAMP_DOWN_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    9.25	9.79	8.56	8.97	9.66	9.98	11.43	14.49	11.28	10.79	9.38	10.17	9.25	9.79	8.56	8.97	9.66	9.98	11.43	14.49	11.28	10.79	9.38	10.17
    16.5	19.48	16.72	17.04	17.01	17.03	16.74	20.94	16.18	14.91	13.48	15.72	16.5	19.48	16.72	17.04	17.01	17.03	16.74	20.94	16.18	14.91	13.48	15.72
    22.72	24.11	21.64	22.18	22.87	23.8	23.77	35.01	26.54	24.21	22.18	24.53	22.72	24.11	21.64	22.18	22.87	23.8	23.77	35.01	26.54	24.21	22.18	24.53
    ]
    REGDN_WIND_RAMP_DOWN_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -9.06	-8.56	-8.92	-10.03	-9.06	-10.88	-12.01	-17.32	-14.8	-12.46	-12.45	-10.99	-9.06	-8.56	-8.92	-10.03	-9.06	-10.88	-12.01	-17.32	-14.8	-12.46	-12.45	-10.99
    -16.94	-15.5	-18.83	-18.78	-15.81	-19.56	-17.31	-23.81	-17.59	-16.15	-15.79	-15.47	-16.94	-15.5	-18.83	-18.78	-15.81	-19.56	-17.31	-23.81	-17.59	-16.15	-15.79	-15.47
    -22.03	-19.2	-22.64	-22.44	-21.24	-26.46	-24.97	-43.86	-34.45	-28.14	-27.18	-25.28	-22.03	-19.2	-22.64	-22.44	-21.24	-26.46	-24.97	-43.86	-34.45	-28.14	-27.18	-25.28
    ]
    FOLUP_WIND_RAMP_DOWN_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    25.1	29.91	33.81	27.29	29.22	28.02	26.62	27.78	34.48	30.34	29.45	33.26	25.1	29.91	33.81	27.29	29.22	28.02	26.62	27.78	34.48	30.34	29.45	33.26
    55.33	65.45	77.97	55.93	66.06	69.25	57.06	57.96	57.69	49.23	50.35	68.12	55.33	65.45	77.97	55.93	66.06	69.25	57.06	57.96	57.69	49.23	50.35	68.12
    89.85	102.22	116.71	101.44	92.08	115.01	106.31	108.91	106.07	90.75	106.2	123.04	89.85	102.22	116.71	101.44	92.08	115.01	106.31	108.91	106.07	90.75	106.2	123.04
    ]
    FOLDN_WIND_RAMP_DOWN_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -41.33	-39.33	-35.25	-33.93	-52.95	-38.31	-45.06	-71.67	-51.03	-77.8	-76.85	-32.31	-41.33	-39.33	-35.25	-33.93	-52.95	-38.31	-45.06	-71.67	-51.03	-77.8	-76.85	-32.31
    -102.46	-94.52	-89.81	-102.77	-134.61	-91.8	-101.62	-123.43	-90.12	-105.75	-123.96	-86.36	-102.46	-94.52	-89.81	-102.77	-134.61	-91.8	-101.62	-123.43	-90.12	-105.75	-123.96	-86.36
    -176.01	-154.81	-138.88	-146.43	-195.17	-157.9	-189.48	-222.61	-168.44	-211.61	-209.47	-156.27	-176.01	-154.81	-138.88	-146.43	-195.17	-157.9	-189.48	-222.61	-168.44	-211.61	-209.47	-156.27
    ]

    REGUP_WIND_NORM_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    8.22	9.52	8.64	8.7	9.43	10.55	11.91	12.35	12.26	11.41	9.78	9.59	8.22	9.52	8.64	8.7	9.43	10.55	11.91	12.35	12.26	11.41	9.78	9.59
    14.79	18.98	16.85	16.56	16.64	17.92	17.39	18.05	17.5	15.72	14.02	14.87	14.79	18.98	16.85	16.56	16.64	17.92	17.39	18.05	17.5	15.72	14.02	14.87
    20.5	23.52	21.8	21.59	22.4	24.96	24.61	30.81	28.49	25.4	23	23.33	20.5	23.52	21.8	21.59	22.4	24.96	24.61	30.81	28.49	25.4	23	23.33
    ]
    REGDN_WIND_NORM_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -8.21	-9.23	-8.27	-8.31	-8.49	-10.2	-12.8	-14.06	-17.93	-15.03	-13.46	-10.57	-8.21	-9.23	-8.27	-8.31	-8.49	-10.2	-12.8	-14.06	-17.93	-15.03	-13.46	-10.57
    -15.47	-16.64	-17.58	-15.81	-14.89	-18.45	-18.39	-19.6	-21.2	-19.36	-17.02	-14.91	-15.47	-16.64	-17.58	-15.81	-14.89	-18.45	-18.39	-19.6	-21.2	-19.36	-17.02	-14.91
    -20.2	-20.56	-21.2	-19	-20.07	-25.07	-26.39	-37.34	-40.41	-33.1	-29.06	-24.47	-20.2	-20.56	-21.2	-19	-20.07	-25.07	-26.39	-37.34	-40.41	-33.1	-29.06	-24.47
    ]
    FOLUP_WIND_NORM_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    37.2	45.15	45.01	34.63	36.13	38.24	36.84	39.27	42.36	43.61	42.3	32.69	37.2	45.15	45.01	34.63	36.13	38.24	36.84	39.27	42.36	43.61	42.3	32.69
    79.57	94.99	100.54	69.98	80.27	91.79	77.13	79.57	70.26	69.41	70.78	67.68	79.57	94.99	100.54	69.98	80.27	91.79	77.13	79.57	70.26	69.41	70.78	67.68
    125.82	143.75	147.45	124.19	110.95	148.88	139.47	144.62	127.17	123.82	142.6	122.97	125.82	143.75	147.45	124.19	110.95	148.88	139.47	144.62	127.17	123.82	142.6	122.97
    ]
    FOLDN_WIND_NORM_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -40.51	-47.26	-44.49	-41.87	-48.95	-43.72	-57.32	-73.03	-62.23	-81.41	-97.28	-44.91	-40.51	-47.26	-44.49	-41.87	-48.95	-43.72	-57.32	-73.03	-62.23	-81.41	-97.28	-44.91
    -100.98	-111.14	-110.59	-122.44	-126.65	-103.54	-125.35	-126.41	-107.84	-110.78	-152.89	-114.9	-100.98	-111.14	-110.59	-122.44	-126.65	-103.54	-125.35	-126.41	-107.84	-110.78	-152.89	-114.9
    -174.74	-178.73	-168.26	-172.68	-186.45	-176.3	-226.93	-228.12	-196.47	-220.43	-250.27	-200.17	-174.74	-178.73	-168.26	-172.68	-186.45	-176.3	-226.93	-228.12	-196.47	-220.43	-250.27	-200.17
    ]

    REGUP_WIND_RAMP_UP_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    6.8	7.07	7.66	7.74	6.17	8.72	9.87	10.98	12.79	11.17	8.45	7.51	6.8	7.07	7.66	7.74	6.17	8.72	9.87	10.98	12.79	11.17	8.45	7.51
    12.36	14.44	15.1	14.87	11.18	15.02	14.57	16.16	18.21	15.41	12.19	11.79	12.36	14.44	15.1	14.87	11.18	15.02	14.57	16.16	18.21	15.41	12.19	11.79
    17.27	18.07	19.63	19.47	15.35	21.16	20.88	27.95	29.52	24.95	20.21	18.84	17.27	18.07	19.63	19.47	15.35	21.16	20.88	27.95	29.52	24.95	20.21	18.84
    ]
    REGDN_WIND_RAMP_UP_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -8.2	-7.83	-8.17	-8.19	-7.72	-9.95	-11.88	-14.25	-17.36	-15.49	-10.98	-7.78	-8.2	-7.83	-8.17	-8.19	-7.72	-9.95	-11.88	-14.25	-17.36	-15.49	-10.98	-7.78
    -15.45	-14.26	-17.39	-15.58	-13.62	-18.04	-17.15	-19.85	-20.55	-19.91	-13.98	-11.1	-15.45	-14.26	-17.39	-15.58	-13.62	-18.04	-17.15	-19.85	-20.55	-19.91	-13.98	-11.1
    -20.18	-17.7	-20.98	-18.73	-18.45	-24.55	-24.75	-37.74	-39.35	-33.94	-24.34	-18.63	-20.18	-17.7	-20.98	-18.73	-18.45	-24.55	-24.75	-37.74	-39.35	-33.94	-24.34	-18.63
    ]
    FOLUP_WIND_RAMP_UP_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    28.9	29.4	34.53	30.19	36.72	42.87	25.73	31.91	35.77	34.26	36.8	26.97	28.9	29.4	34.53	30.19	36.72	42.87	25.73	31.91	35.77	34.26	36.8	26.97
    62.27	63.92	79.14	60.22	80.49	100.41	55.61	66.31	59.32	55.21	61.95	55.99	62.27	63.92	79.14	60.22	80.49	100.41	55.61	66.31	59.32	55.21	61.95	55.99
    99.47	99.3	117.76	108.5	108.79	157.47	103.41	120.9	107.65	100.02	126.73	103.2	99.47	99.3	117.76	108.5	108.79	157.47	103.41	120.9	107.65	100.02	126.73	103.2
    ]
    FOLDN_WIND_RAMP_UP_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -33.15	-35.66	-28.24	-24.5	-34.28	-38.76	-45.02	-55.34	-40.75	-66.81	-80.69	-29.38	-33.15	-35.66	-28.24	-24.5	-34.28	-38.76	-45.02	-55.34	-40.75	-66.81	-80.69	-29.38
    -84.28	-86.48	-73.4	-77.09	-92.81	-92.58	-101.75	-98.24	-73.13	-91.63	-129.2	-79.41	-84.28	-86.48	-73.4	-77.09	-92.81	-92.58	-101.75	-98.24	-73.13	-91.63	-129.2	-79.41
    -148.1	-142.81	-115.26	-111.96	-139.54	-158.55	-189.06	-184.65	-140.2	-188.32	-216.21	-144.7	-148.1	-142.81	-115.26	-111.96	-139.54	-158.55	-189.06	-184.65	-140.2	-188.32	-216.21	-144.7
    ]

    REGUP_WIND_FULL_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    7.7	8.23	8.07	8.08	7.42	9.5	11.11	12.06	12.18	11.29	9.39	9.05	7.7	8.23	8.07	8.08	7.42	9.5	11.11	12.06	12.18	11.29	9.39	9.05
    13.91	16.63	15.84	15.47	13.33	16.27	16.3	17.65	17.4	15.56	13.49	14.1	13.91	16.63	15.84	15.47	13.33	16.27	16.3	17.65	17.4	15.56	13.49	14.1
    19.34	20.72	20.55	20.22	18.16	22.81	23.18	30.21	28.34	25.18	22.19	22.22	19.34	20.72	20.55	20.22	18.16	22.81	23.18	30.21	28.34	25.18	22.19	22.22
    ]
    REGDN_WIND_FULL_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -8.3	-8.85	-8.3	-8.45	-8.32	-10.24	-12.38	-14.38	-17.32	-14.94	-12.57	-9.92	-8.3	-8.85	-8.3	-8.45	-8.32	-10.24	-12.38	-14.38	-17.32	-14.94	-12.57	-9.92
    -15.62	-15.99	-17.65	-16.04	-14.62	-18.51	-17.83	-20.02	-20.51	-19.24	-15.94	-14.04	-15.62	-15.99	-17.65	-16.04	-14.62	-18.51	-17.83	-20.02	-20.51	-19.24	-15.94	-14.04
    -20.4	-19.78	-21.28	-19.27	-19.72	-25.14	-25.65	-38.01	-39.29	-32.92	-27.41	-23.16	-20.4	-19.78	-21.28	-19.27	-19.72	-25.14	-25.65	-38.01	-39.29	-32.92	-27.41	-23.16
    ]
    FOLUP_WIND_FULL_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    29.29	33.89	35.06	29.55	32.61	32.47	28.82	31.83	36.34	36.15	37.39	29.23	29.29	33.89	35.06	29.55	32.61	32.47	28.82	31.83	36.34	36.15	37.39	29.23
    63.19	72.84	80.32	59.28	72.63	79.25	61.81	66.12	60.34	58.11	62.93	60.42	63.19	72.84	80.32	59.28	72.63	79.25	61.81	66.12	60.34	58.11	62.93	60.42
    101.01	112.1	119.53	107.02	99.29	128.84	113.87	121.06	109.67	104.93	128.62	110.58	101.01	112.1	119.53	107.02	99.29	128.84	113.87	121.06	109.67	104.93	128.62	110.58
    ]
    FOLDN_WIND_FULL_HIDIV = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
    -36.07	-38.54	-34.94	-29.23	-43.03	-39.21	-51.75	-66.01	-51.6	-76.71	-90.11	-39.34	-36.07	-38.54	-34.94	-29.23	-43.03	-39.21	-51.75	-66.01	-51.6	-76.71	-90.11	-39.34
    -90.89	-92.62	-89.04	-90.36	-113.25	-93.62	-115	-114.89	-91.03	-104.35	-142.42	-102.8	-90.89	-92.62	-89.04	-90.36	-113.25	-93.62	-115	-114.89	-91.03	-104.35	-142.42	-102.8
    -158.35	-151.77	-137.69	-129.8	-167.15	-160.33	-209.73	-210.06	-169.54	-209.34	-234.55	-180.95	-158.35	-151.77	-137.69	-129.8	-167.15	-160.33	-209.73	-210.06	-169.54	-209.34	-234.55	-180.95
    ]
    


    REGUP_WIND_HIDIV = [REGUP_WIND_RAMP_DOWN_HIDIV,REGUP_WIND_NORM_HIDIV,REGUP_WIND_RAMP_UP_HIDIV,REGUP_WIND_FULL_HIDIV]
    REGUP_WIND_CAPEX = [REGUP_WIND_RAMP_DOWN_CAPEX,REGUP_WIND_NORM_CAPEX,REGUP_WIND_RAMP_UP_CAPEX,REGUP_WIND_FULL_CAPEX]
    REGDN_WIND_HIDIV = [REGDN_WIND_RAMP_DOWN_HIDIV,REGDN_WIND_NORM_HIDIV,REGDN_WIND_RAMP_UP_HIDIV,REGDN_WIND_FULL_HIDIV]
    REGDN_WIND_CAPEX = [REGDN_WIND_RAMP_DOWN_CAPEX,REGDN_WIND_NORM_CAPEX,REGDN_WIND_RAMP_UP_CAPEX,REGDN_WIND_FULL_CAPEX]
    FOLUP_WIND_HIDIV = [FOLUP_WIND_RAMP_DOWN_HIDIV,FOLUP_WIND_NORM_HIDIV,FOLUP_WIND_RAMP_UP_HIDIV,FOLUP_WIND_FULL_HIDIV]
    FOLUP_WIND_CAPEX = [FOLUP_WIND_RAMP_DOWN_CAPEX,FOLUP_WIND_NORM_CAPEX,FOLUP_WIND_RAMP_UP_CAPEX,FOLUP_WIND_FULL_CAPEX]
    FOLDN_WIND_HIDIV = [FOLDN_WIND_RAMP_DOWN_HIDIV,FOLDN_WIND_NORM_HIDIV,FOLDN_WIND_RAMP_UP_HIDIV,FOLDN_WIND_FULL_HIDIV]
    FOLDN_WIND_CAPEX = [FOLDN_WIND_RAMP_DOWN_CAPEX,FOLDN_WIND_NORM_CAPEX,FOLDN_WIND_RAMP_UP_CAPEX,FOLDN_WIND_FULL_CAPEX]


    global REGUP_WIND = [REGUP_WIND_CAPEX,REGUP_WIND_HIDIV]
    global REGDN_WIND = [REGDN_WIND_CAPEX,REGDN_WIND_HIDIV]
    global FOLUP_WIND = [FOLUP_WIND_CAPEX,FOLUP_WIND_HIDIV]
    global FOLDN_WIND = [FOLDN_WIND_CAPEX,FOLDN_WIND_HIDIV]

    # MONTHS = [1202210    1202211    1202212    1202301    1202302    1202303    1202304    1202305    1202306    1202307    1202308    1202309    2202210    2202211    2202212    2202301    2202302    2202303    2202304    2202305    2202306    2202307    2202308    2202309]
    # dayMonth = [31    30    31    31    28    31    30    31    30    31    31    30    31    30    31    31    28    31    30    31    30    31    31    30]
    # StartMonth = [1    745    1465    2209    2953    3625    4369    5089    5833    6553    7297    8041    8761    9505    10225    10969    11713    12385    13129    13849    14593    15313    16057    16801]
    # EndMonth = [744    1464    2208    2952    3624    4368    5088    5832    6552    7296    8040    8760    9504    10224    10968    11712    12384    13128    13848    14592    15312    16056    16800    17520]
    
    # for t = initial:T
    #     for i= 1:length(MONTHS)
    #         if t>=StartMonth[i] && t<=EndMonth[i]
    #             counter = i
    #             println(counter)
    #             break
    #         end
    #     end

    # end
    WIND_DIV_PORT = [1 , 0]
    WIND_IC = 717.2
    LOAD_PK = 1
    # WIND_PENETRATION = WIND_IC/LOAD_PK*100; # A percentage
    WIND_PENETRATION = 15
    global WREGUPTD = zeros(2,T)
    for DIVERISTY = 1:2
        snpce = length(PENETRATION)
        limit = zeros(snpce)
        y = zeros(snpce)
        for n = 1:snpce
            limit[n] = PENETRATION[n]
        end
        CLASS = 2*ones(T)
        for t = initial:T
            for i= 1:length(MONTHS)
                if t>=StartMonth[i] && t<=EndMonth[i]
                    global counter = i
                    break
                end
            end
            CLASS[t] = NORM
            if DIFF[t] <= LOW_LIMIT
                CLASS[t] = RAMP_DOWN
            end
            if DIFF[t] >= HI_LIMIT 
                CLASS[t] = RAMP_UP
            end
            for n = 1:snpce
                y[n] = REGUP_WIND[DIVERISTY][Int(CLASS[t])][n,counter]
            end
            Val = WIND_PENETRATION*LOAD_PK/LOAD_PK
            for n = 1:snpce-1
                if limit[n+1] >= Val && limit[n] <= Val
                    WREGUPTD[DIVERISTY,t] = y[n] + (y[n+1] - y[n])/(max(1,limit[n+1] - limit[n]))*(Val-limit[n])
                    break
                end
            end
        end
    end
    global WREGUPT = zeros(T)
    for t = initial:T
        WREGUPT[t] =  WREGUPTD[1,t]*WIND_DIV_PORT[1] + WREGUPTD[2,t]*WIND_DIV_PORT[2]
    end

    WREGDNTD = zeros(2,T)
    for DIVERISTY = 1:2
        snpce = length(PENETRATION)
        limit = zeros(snpce)
        y = zeros(snpce)
        for n = 1:snpce
            limit[n] = PENETRATION[n]
        end
        CLASS = 2*ones(T)
        for t = initial:T
            for i= 1:length(MONTHS)
                if t>=StartMonth[i] && t<=EndMonth[i]
                    global counter = i
                    break
                end
            end
            CLASS[t] = NORM
            if DIFF[t] <= LOW_LIMIT
                CLASS[t] = RAMP_DOWN
            end
            if DIFF[t] >= HI_LIMIT 
                CLASS[t] = RAMP_UP
            end
            for n = 1:snpce
                y[n] = REGDN_WIND[DIVERISTY][Int(CLASS[t])][n,counter]
            end
            Val = WIND_PENETRATION*LOAD_PK/LOAD_PK
            for n = 1:snpce-1
                if limit[n+1] >= Val && limit[n] <= Val
                    WREGDNTD[DIVERISTY,t] = y[n] + (y[n+1] - y[n])/(max(1,limit[n+1] - limit[n]))*(Val-limit[n])
                    break
                end
            end
        end
    end
    WREGDNT = zeros(T)
    for t = initial:T
        WREGDNT[t] =  WREGDNTD[1,t]*WIND_DIV_PORT[1] + WREGDNTD[2,t]*WIND_DIV_PORT[2]
    end

    WFOLUPTD = zeros(2,T)
    for DIVERISTY = 1:2
        snpce = length(PENETRATION)
        limit = zeros(snpce)
        y = zeros(snpce)
        for n = 1:snpce
            limit[n] = PENETRATION[n]
        end
        CLASS = 2*ones(T)
        for t = initial:T
            for i= 1:length(MONTHS)
                if t>=StartMonth[i] && t<=EndMonth[i]
                    global counter = i
                    break
                end
            end
            CLASS[t] = NORM
            if DIFF[t] <= LOW_LIMIT
                CLASS[t] = RAMP_DOWN
            end
            if DIFF[t] >= HI_LIMIT 
                CLASS[t] = RAMP_UP
            end
            for n = 1:snpce
                y[n] = FOLUP_WIND[DIVERISTY][Int(CLASS[t])][n,counter]
            end
            Val = WIND_PENETRATION*LOAD_PK/LOAD_PK
            for n = 1:snpce-1
                if limit[n+1] >= Val && limit[n] <= Val
                    WFOLUPTD[DIVERISTY,t] = y[n] + (y[n+1] - y[n])/(max(1,limit[n+1] - limit[n]))*(Val-limit[n])
                    break
                end
            end
        end
    end
    WFOLUPT = zeros(T)
    for t = initial:T
        WFOLUPT[t] =  WFOLUPTD[1,t]*WIND_DIV_PORT[1] + WFOLUPTD[2,t]*WIND_DIV_PORT[2]
    end

    WFOLDNTD = zeros(2,T)
    for DIVERISTY = 1:2
        snpce = length(PENETRATION)
        limit = zeros(snpce)
        y = zeros(snpce)
        for n = 1:snpce
            limit[n] = PENETRATION[n]
        end
        CLASS = 2*ones(T)
        for t = initial:T
            for i= 1:length(MONTHS)
                if t>=StartMonth[i] && t<=EndMonth[i]
                    global counter = i
                    break
                end
            end
            CLASS[t] = NORM
            if DIFF[t] <= LOW_LIMIT
                CLASS[t] = RAMP_DOWN
            end
            if DIFF[t] >= HI_LIMIT 
                CLASS[t] = RAMP_UP
            end
            for n = 1:snpce
                y[n] = FOLDN_WIND[DIVERISTY][Int(CLASS[t])][n,counter]
            end
            Val = WIND_PENETRATION*LOAD_PK/LOAD_PK
            for n = 1:snpce-1
                if limit[n+1] >= Val && limit[n] <= Val
                    WFOLDNTD[DIVERISTY,t] = y[n] + (y[n+1] - y[n])/(max(1,limit[n+1] - limit[n]))*(Val-limit[n])
                    break
                end
            end
        end
    end
    WFOLDNT = zeros(T)
    for t = initial:T
        WFOLDNT[t] =  WFOLDNTD[1,t]*WIND_DIV_PORT[1] + WFOLDNTD[2,t]*WIND_DIV_PORT[2]
    end

    WCROTD = zeros(2,T)
    for DIVERISTY = 1:2
        snpce = length(PENETRATION)
        limit = zeros(snpce)
        y = zeros(snpce)
        for n = 1:snpce
            limit[n] = PENETRATION[n]
        end
        CLASS = 2*ones(T)
        for t = initial:T
            for i= 1:length(MONTHS)
                if t>=StartMonth[i] && t<=EndMonth[i]
                    global counter = i
                    break
                end
            end
            CLASS[t] = NORM
            if DIFF[t] <= LOW_LIMIT
                CLASS[t] = RAMP_DOWN
            end
            if DIFF[t] >= HI_LIMIT 
                CLASS[t] = RAMP_UP
            end
            for n = 1:snpce
                y[n] = CRO_WIND[n,counter]
            end
            Val = WIND_PENETRATION*LOAD_PK/LOAD_PK
            for n = 1:snpce-1
                if limit[n+1] >= Val && limit[n] <= Val
                    WCROTD[DIVERISTY,t] = y[n] + (y[n+1] - y[n])/(max(1,limit[n+1] - limit[n]))*(Val-limit[n])
                    break
                end
            end
        end
    end
    WCROT = zeros(T)
    for t = initial:T
        WCROT[t] =  WCROTD[1,t]*WIND_DIV_PORT[1] + WCROTD[2,t]*WIND_DIV_PORT[2]
    end

    WIND0 = data.WIND0[1]
    WIND = data.WINDR
    WIND_ICnoR = WIND_IC
    WIND0noR = WIND0

    global WTotalUpResT = zeros(T)
    global WTotalDNResT = zeros(T)
    global LTotalUpResT = zeros(T)
    global LTotalDNResT = zeros(T)

    for t = initial:T
        if t==1
            WTotalUpResT[t] = min(WIND0noR,(WREGUPT[t] + WFOLUPT[t]))
            WTotalDNResT[t] = min(WIND_ICnoR-WIND0noR,(-WREGDNT[t] - WFOLDNT[t]))

        else
            WTotalUpResT[t] = min(WIND[t-1],(WREGUPT[t] + WFOLUPT[t]))
            WTotalDNResT[t] = min(WIND_ICnoR-WIND[t-1],(-WREGDNT[t] - WFOLDNT[t]))
        end

    end
end
WindCalc()